var e=require("@urql/core"),t=require("react"),r=require("wonka"),n=require("use-sync-external-store/shim"),u=e.createClient({url:"/graphql"}),o=t.createContext(u),i=o.Provider,s=o.Consumer;function c(){return t.useContext(o)}function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}o.displayName="UrqlContext";var f={fetching:!1,stale:!1,error:void 0,data:void 0,extensions:void 0,operation:void 0};function l(e,t){var r=a({},e,t,{data:void 0!==t.data||t.error?t.data:e.data,fetching:!!t.fetching,stale:!!t.stale});return function(e,t){if("object"!=typeof e||"object"!=typeof t)return e!==t;for(var r in e)if(!(r in t))return!0;for(var n in t)if(e[n]!==t[n])return!0;return!1}(e,r)?r:e}function p(e,t){for(var r=0,n=t.length;r<n;r++)if(e[r]!==t[r])return!0;return!1}function v(n){var u=t.useRef(!0),o=c(),i=t.useState(f),s=i[0],l=i[1],p=t.useCallback((function(t,i){return l(a({},f,{fetching:!0})),r.toPromise(o.executeMutation(e.createRequest(n,t),i||{})).then((function(e){return u.current&&l({fetching:!1,stale:!!e.stale,data:e.data,error:e.error,extensions:e.extensions,operation:e.operation}),e}))}),[o,n,l]);return t.useEffect((function(){return u.current=!0,function(){u.current=!1}}),[]),[s,p]}function d(r,n){var u=t.useRef(void 0);return t.useMemo((function(){var t=e.createRequest(r,n);return void 0!==u.current&&u.current.key===t.key?u.current:(u.current=t,t)}),[r,n])}var x=f,y=a({},f,{fetching:!0});function b(e,t){return e.suspense&&(!t||!1!==t.suspense)}function h(e){var u=c(),o=d(e.query,e.variables),i=function(e){if(!e._react){var t=new Set,n=new Map;e.operations$&&r.subscribe((function(e){"teardown"===e.kind&&t.has(e.key)&&(t.delete(e.key),n.delete(e.key))}))(e.operations$),e._react={get:function(e){return n.get(e)},set:function(e,r){t.delete(e),n.set(e,r)},dispose:function(e){t.add(e)}}}return e._react}(u),s=[u,o,e.pause,e.requestPolicy,e.context],f=t.useState((function(){return{source:e.pause?null:u.executeQuery(o,a({},{requestPolicy:e.requestPolicy},e.context)),prevValue:x,deps:s,suspense:b(u,e.context)}})),v=f[0],h=f[1],q=v.source,g=v.deps,k=v.suspense,P=t.useMemo((function(){var e=i.get(o.key);return[function(){if(!q)return x;if(e){if(k&&null!=e&&"then"in e)throw e}else{var t,n=r.subscribe((function(r){e=r,k&&i.set(o.key,e),t&&(t(e),t=void 0)}))(r.takeWhile((function(){return k&&(!t||e&&e.then)||!e}))(q));if(null==e&&k){var u=e=new Promise((function(e){t=e}));throw i.set(o.key,u),u}n.unsubscribe()}return e||y},function(t){if(!q)return function(){};var n=r.subscribe((function(r){e=r,k&&i.set(o.key,e),t()}))(q).unsubscribe;return function(){i.dispose(o.key),n()}}]}),[q,e.pause]),C=P[0],S=P[1],m=t.useCallback((function(t){var r=a({},{requestPolicy:e.requestPolicy},e.context,t);h((function(e){return{prevValue:e.prevValue,deps:e.deps,source:u.executeQuery(o,r),suspense:b(u,r)}}))}),[u,o,e.requestPolicy,e.context]),w=v.prevValue=l(v.prevValue,n.useSyncExternalStore(S,C,C));return p(g,s)&&!e.pause&&h({prevValue:w,source:e.pause?null:u.executeQuery(o,a({},{requestPolicy:e.requestPolicy},e.context)),deps:s,suspense:b(u,e.context)}),[w,m]}function q(e,n){var u=c(),o=d(e.query,e.variables),i=t.useRef(n);i.current=n;var s=t.useMemo((function(){return e.pause?null:u.executeSubscription(o,e.context)}),[u,o,e.pause,e.context]),v=[u,o,e.context,e.pause],x=t.useState((function(){return[s,a({},f,{fetching:!!s}),v]})),y=x[0],b=x[1],h=y[1];return s!==y[0]&&p(y[2],v)&&b([s,h=l(y[1],{fetching:!!s}),v]),t.useEffect((function(){function e(e){b((function(t){var r=l(t[1],e);return t[1]===r?t:(i.current&&t[1].data!==r.data&&(r.data=i.current(t[1].data,r.data)),[t[0],r,t[2]])}))}if(y[0])return r.subscribe(e)(r.onEnd((function(){e({fetching:!1})}))(y[0])).unsubscribe;e({fetching:!1})}),[y[0]]),[h,t.useCallback((function(t){var r=u.executeSubscription(o,a({},e.context,t));b((function(e){return[r,e[1],e[2]]}))}),[u,e.context,o])]}exports.Consumer=s,exports.Context=o,exports.Mutation=function(e){var t=v(e.query);return e.children(a({},t[0],{executeMutation:t[1]}))},exports.Provider=i,exports.Query=function(e){var t=h(e);return e.children(a({},t[0],{executeQuery:t[1]}))},exports.Subscription=function(e){var t=q(e,e.handler);return e.children(a({},t[0],{executeSubscription:t[1]}))},exports.useClient=c,exports.useMutation=v,exports.useQuery=h,exports.useSubscription=q,Object.keys(e).forEach((function(t){"default"===t||exports.hasOwnProperty(t)||(exports[t]=e[t])}));
//# sourceMappingURL=urql.min.js.map
